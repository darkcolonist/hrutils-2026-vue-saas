import{j as a}from"./app-DzK1gbCK.js";import y from"./CustomCalendar-CuQiuEB9.js";import{A as _}from"./AxiosWrapper-D0Xio5Ph.js";import{C as j}from"./JsonView-DB6OvlW2.js";import{C}from"./CustomDialog-DqlvYqbB.js";import{m as p}from"./moment-DLzRzeJX.js";import{B as m}from"./Box-D6Lgme0E.js";import{A as c}from"./Avatar-B86caYYU.js";import{B as g}from"./Badge-BachXXc0.js";import"./toPropertyKey-BO3vai8f.js";import"./createTheme-C3PDnj56.js";import"./assertThisInitialized-B9jnkVVz.js";import"./inheritsLoose-B8YXPC31.js";import"./index-CvodmsZY.js";import"./createPopper-D0FOOgzE.js";import"./useTheme-BadDaQPl.js";import"./styled-DmLGLTNf.js";import"./emotion-react.browser.esm-DYW1Qt72.js";/* empty css             */import"./DialogContent-FO_bFTgm.js";import"./Paper-DU_MpVWS.js";import"./Modal-CwkGqN9h.js";import"./createSvgIcon-DGBPCsNV.js";import"./SvgIcon-B2duuu6b.js";import"./Portal-BKL6eDyi.js";import"./utils-Dtlv9x_c.js";import"./TransitionGroupContext-Mvz6PzCh.js";import"./DialogTitle-BjIhsvYH.js";import"./Typography-B65R2bHg.js";import"./extendSxProp-CxCUejmT.js";import"./Button-Cp_uUmXX.js";import"./ButtonBase-CN_vy0sz.js";import"./useIsFocusVisible-Bb7ccel6.js";import"./usePreviousProps-D5vB_2V6.js";const u="green",l="grey",f="red",D=({leaves:t,day:r,formats:e,...s})=>a.jsx(m,{component:"span",sx:{display:"flex",flexWrap:"wrap",overflow:"hidden"},children:t.map((o,i)=>a.jsx(S,{formats:e,leave:o},i))}),L=({specialDays:t,day:r,formats:e,specialField:s,...o})=>{const i=t.filter(d=>d[s]===r);return a.jsx(m,{component:"span",sx:{display:"flex",flexWrap:"wrap",overflow:"hidden"},children:i.map((d,n)=>a.jsx(O,{formats:e,specialDay:d},n))})};function b(t,r){const e=p(t.day).format(r.dates.front_end_moment_human_date);return`leave details of ${t.first_name.split(" ")[0]} on ${e}`}function w(t,r){t.start_date=p(t.start_date).format(r.dates.front_end_moment_human_date),t.end_date=p(t.end_date).format(r.dates.front_end_moment_human_date),t.paid=t.is_with_pay?"yes":"no",t.halfday=t.is_halfday?"yes":"no",t.reason=t.reason.trim(),t.executor=t.executor?t.executor.split(" ")[0]:null,t.days=Array.isArray(t.days)?t.days:JSON.parse(t.days);const e=["status","reason","start_date","end_date","days","executor","halfday","period","leave_hash","paid"],s=Object.keys(t).filter(o=>e.includes(o)).reduce((o,i)=>(o[i]=t[i],o),{});return a.jsx(j,{src:s})}const O=({specialDay:t,formats:r,...e})=>{const s=t.first_name.split(" ")[0];return a.jsx(c,{component:"span",title:s,sx:{width:24,height:24,m:"1px"},src:t.avatar,children:s})},A=({leave:t,children:r,component:e="span",...s})=>a.jsx(g,{overlap:"circular",component:e,anchorOrigin:{vertical:t.period==="am"?"top":"bottom",horizontal:"right"},badgeContent:a.jsx(c,{sx:{width:10,height:10,fontSize:5,textTransform:"uppercase",backgroundColor:(()=>{switch(t.status){case"pending":return l;case"approved":return u;default:return f}})(),color:"#333"},title:`halfday ${t.period}`,component:e,children:t.period[0]}),children:r}),S=({leave:t,formats:r,...e})=>{const s=t.first_name.split(" ")[0];let o=a.jsx(c,{component:"span",title:s,sx:{width:24,height:24,m:"1px",border:(()=>{switch(t.status){case"pending":return`2px solid ${l}`;case"approved":return`2px solid ${u}`;default:return`2px solid ${f}`}})()},src:t.avatar,children:s});return o=a.jsx(C,{component:"span",buttonLabel:o,dialogTitle:b(t,r),dialogContent:w(t,r)}),t.is_halfday===1&&(o=a.jsx(A,{leave:t,children:o})),o},R=(t,r)=>{const e=[],o=t.leaves.filter(n=>e.includes(n.day)?!1:(e.push(n.day),!0)).map(n=>{const h=t.leaves.filter(x=>x.day===n.day);return{title:a.jsx(D,{formats:r,leaves:h,day:n.day}),start:n.day,end:n.day,allDay:!0,type:"leave"}});return[...t.special.map(n=>({title:a.jsx(L,{specialDays:t.special,day:n.birth_date,formats:r,specialField:"birth_date"}),start:n.birth_date,end:n.birth_date,allDay:!0,type:"birthday"})),...o]};function mt({formats:t,...r}){return a.jsx(m,{sx:{py:1},children:a.jsx(_,{method:"post",routeName:"attendance.calendar",after:e=>{const s=R(e,t);return a.jsx(y,{data:s})}})})}export{mt as default};
